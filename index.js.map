{"version":3,"file":"index.js","sources":["../src/js/utils/notifications.js","../src/js/exercises.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const NOTIFICATION_TYPES = {\n  error: 'error',\n  success: 'success',\n};\n\nconst THEME = {\n  [NOTIFICATION_TYPES.error]: {\n    backgroundColor: '#EF4040',\n    messageColor: '#FFFFFF',\n  },\n  [NOTIFICATION_TYPES.success]: {\n    backgroundColor: '#59A10D',\n    messageColor: '#FFFFFF',\n  },\n};\n\nexport const showNotification = (message, type = NOTIFICATION_TYPES.error) => {\n  iziToast.show({\n    ...THEME[type],\n    message,\n    messageSize: '16px',\n    position: 'topRight',\n    maxWidth: 380,\n  });\n};\n","import Api from './api';\nimport {\n  getClosest,\n  renderByExercises,\n  renderByFilters,\n  renderFilters,\n  renderPagination,\n  showNotification,\n} from './utils';\n\n(() => {\n  const HIDDEN_CLASS = 'hidden';\n  const FILTERS = {\n    muscles: 'Muscles',\n    bodyParts: 'Body parts',\n    equipment: 'Equipment',\n  };\n  const DEFAULT_FILTER = FILTERS.muscles;\n  const SEARCH_FILTER_MAPPING = {\n    [FILTERS.muscles]: 'muscles',\n    [FILTERS.bodyParts]: 'bodypart',\n    [FILTERS.equipment]: 'equipment',\n  };\n  const state = {\n    filter: null,\n    exercise: null,\n    keyword: '',\n    pagination: {\n      filters: {\n        currentPage: 1,\n        totalPages: 1,\n        limit: 12,\n      },\n      exercises: {\n        currentPage: 1,\n        totalPages: 1,\n        limit: 10,\n      },\n    },\n  };\n\n  const breadcrumbsNav = document.getElementById('breadcrumbs-nav');\n  const breadcrumbsHome = breadcrumbsNav.querySelector('.item-home');\n  const breadcrumbsFilters = document.getElementById('breadcrumbs-filters');\n  const exercisesWrapper = document.querySelector('.exercises');\n  const cards = exercisesWrapper.querySelector('.cards');\n  const cardsExercises = exercisesWrapper.querySelector('.cards-exercises');\n  const searchField = document.getElementById('search-field');\n  const searchForm = searchField.querySelector('.search-form');\n  const searchFieldInput = searchField.querySelector('.search-input');\n  const searchFieldSubmit = searchField.querySelector('.seach-submit');\n  const searchFieldReset = searchField.querySelector('.seach-reset');\n  const paginationContainer = exercisesWrapper.querySelector('.pagination');\n\n  // helpers\n  const updateLimits = () => {\n    if (window.innerWidth < 768) {\n      state.pagination.filters.limit = 9;\n      state.pagination.exercises.limit = 8;\n    }\n  };\n\n  const showLoader = (shouldHide = false) => {\n    if (shouldHide) {\n      const loader = exercisesWrapper.querySelector('.loader');\n\n      if (loader) {\n        loader.remove();\n      }\n    } else {\n      const adjacentText = `<div class=\"loader\"></div>`;\n      exercisesWrapper.insertAdjacentHTML('beforeend', adjacentText);\n    }\n  };\n\n  /**\n   * Show / hide the search field's reset button\n   *\n   * @param {boolean} shouldHide\n   */\n  const showResetButton = (shouldHide = false) => {\n    if (shouldHide) {\n      searchFieldReset.classList.add(HIDDEN_CLASS);\n    } else {\n      searchFieldReset.classList.remove(HIDDEN_CLASS);\n    }\n  };\n\n  /**\n   * Show / hide and clear the search field's input\n   *\n   * @param {boolean} shouldHide\n   * @param {boolean} shouldClear\n   */\n  const showSearchField = (shouldHide = false, shouldClear = false) => {\n    if (shouldHide) {\n      searchField.classList.add(HIDDEN_CLASS);\n    } else {\n      searchField.classList.remove(HIDDEN_CLASS);\n    }\n\n    if (shouldClear) {\n      searchFieldInput.value = '';\n    }\n  };\n\n  /**\n   * Clear all cards, should be called before calling api\n   */\n  const clearCards = () => {\n    cards.innerHTML = '';\n    cardsExercises.innerHTML = '';\n  };\n\n  /**\n   * Clear an exercise in breadcrums\n   */\n  const clearBreadcrumbs = () => {\n    const categoryItem = breadcrumbsNav.querySelector('.item-exercise');\n    categoryItem.removeAttribute('title');\n    categoryItem.classList.remove('active');\n    categoryItem.innerText = '';\n  };\n\n  /**\n   * Add / update an exercise in breadcrums\n   */\n  const updateBreadcrumbs = exercise => {\n    const categoryItem = breadcrumbsNav.querySelector('.item-exercise');\n    categoryItem.setAttribute('title', exercise);\n    categoryItem.classList.add('active');\n    categoryItem.innerText = exercise;\n  };\n\n  /**\n   * Calls API to get exercises\n   *\n   * @param {string} filter\n   * @param {string} exercise\n   * @param {string} keyword\n   */\n  const searchByExercise = async (filter, exercise, keyword = '') => {\n    try {\n      clearCards();\n      showLoader();\n      updateBreadcrumbs(exercise);\n      const { limit, currentPage } = state.pagination.exercises;\n      const params = {\n        [SEARCH_FILTER_MAPPING[filter]]: exercise,\n        keyword,\n        limit,\n        page: currentPage,\n      };\n\n      const response = await Api.getExercises(params);\n      const { results, totalPages, perPage } = response;\n      state.exercise = exercise;\n      state.keyword = keyword;\n\n      // checking for empty response from api\n      if (results.length === 0) {\n        showNotification(\n          'Sorry, there are no matching your request. Please try again!'\n        );\n        return;\n      }\n\n      state.pagination.exercises.totalPages = parseInt(totalPages);\n      state.pagination.exercises.currentPage = currentPage + 1;\n      state.pagination.exercises.limit = parseInt(perPage);\n\n      renderByExercises(results, cardsExercises);\n      renderPagination(paginationContainer, totalPages, currentPage);\n\n      // checking if the end of search results has been reached\n      if (currentPage > totalPages) {\n        showNotification(\"We're sorry, but you've reached the end of results.\");\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      showLoader(true);\n      showSearchField();\n    }\n  };\n\n  /**\n   * Calls API to get filters\n   *\n   * @param {string} filter\n   */\n  const searchByFilter = async filter => {\n    try {\n      clearCards();\n      clearBreadcrumbs();\n      showLoader();\n      showSearchField(true, true);\n      const { limit, currentPage } = state.pagination.filters;\n      const response = await Api.getFilters({\n        filter,\n        limit,\n        page: currentPage,\n      });\n      const { results, totalPages, perPage } = response;\n      state.filter = filter;\n      state.exercise = null;\n\n      // checking for empty response from api\n      if (results.length === 0) {\n        showNotification(\n          'Sorry, there are no matching your request. Please try again!'\n        );\n        return;\n      }\n\n      state.pagination.filters.totalPages = parseInt(totalPages);\n      state.pagination.filters.currentPage = currentPage + 1;\n      state.pagination.filters.limit = parseInt(perPage);\n\n      renderByFilters(results, cards);\n      renderPagination(paginationContainer, totalPages, currentPage);\n\n      // checking if the end of search results has been reached\n      if (currentPage > totalPages) {\n        showNotification(\"We're sorry, but you've reached the end of results.\");\n      }\n\n      // highlight active filter\n      const filterElements = breadcrumbsFilters.querySelectorAll('.item');\n\n      for (let filterElement of filterElements) {\n        if (filterElement.innerText === filter) {\n          filterElement.classList.add('active');\n        } else {\n          filterElement.classList.remove('active');\n        }\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      showLoader(true);\n    }\n  };\n\n  // filter click listerner\n  const filterClickHandler = event => {\n    event.preventDefault();\n    const isFilterLink =\n      event.target.className && event.target.className.includes('filter-link');\n\n    if (!isFilterLink) {\n      return;\n    }\n\n    const filter = event.target.innerText.trim();\n    state.pagination.filters.currentPage = 1;\n    state.pagination.exercises.currentPage = 1;\n    searchByFilter(filter);\n  };\n\n  breadcrumbsFilters.addEventListener('click', filterClickHandler);\n\n  // exercise click listerner\n  const exerciseClickHandler = event => {\n    event.preventDefault();\n    const { filter } = state;\n    const cardLink = getClosest(event.target, '.card-item');\n\n    if (!cardLink) {\n      return;\n    }\n\n    if (cardLink.dataset && cardLink.dataset.exercise) {\n      const exercise = cardLink.dataset.exercise.trim();\n      state.pagination.filters.currentPage = 1;\n      state.pagination.exercises.currentPage = 1;\n      searchByExercise(filter, exercise);\n    }\n  };\n\n  cards.addEventListener('click', exerciseClickHandler);\n\n  // form listerners\n  const searchHandler = event => {\n    event.preventDefault();\n    const { filter, exercise } = state;\n    const keyword = searchFieldInput.value.trim();\n\n    if (keyword) {\n      searchByExercise(filter, exercise, keyword);\n    }\n  };\n\n  const formResetHandler = () => {\n    showResetButton(true);\n    const { filter, exercise } = state;\n    searchByExercise(filter, exercise);\n  };\n\n  searchFieldSubmit.addEventListener('click', searchHandler);\n  searchForm.addEventListener('submit', searchHandler);\n  searchForm.addEventListener('reset', formResetHandler);\n\n  // search input listerner\n  const searchInputHandler = event => {\n    if (event.target.value.trim()) {\n      showResetButton();\n    } else {\n      showResetButton(true);\n    }\n  };\n\n  searchFieldInput.addEventListener('input', searchInputHandler);\n\n  // search input listerner\n  const paginationHandler = event => {\n    event.preventDefault();\n    const pageLink = getClosest(event.target, '.list-item');\n\n    if (pageLink && pageLink.dataset.page) {\n      const { filter, exercise, keyword } = state;\n      const currentPage = parseInt(pageLink.dataset.page);\n\n      if (exercise) {\n        state.pagination.filters.currentPage = 1;\n        state.pagination.exercises.currentPage = currentPage;\n        searchByExercise(filter, exercise, keyword);\n      } else {\n        state.pagination.exercises.currentPage = 1;\n        state.pagination.filters.currentPage = currentPage;\n        searchByFilter(filter);\n      }\n    }\n  };\n\n  paginationContainer.addEventListener('click', paginationHandler);\n\n  breadcrumbsHome.addEventListener('click', event => {\n    event.preventDefault();\n    state.pagination.filters.currentPage = 1;\n    state.pagination.exercises.currentPage = 1;\n    searchByFilter(DEFAULT_FILTER);\n  });\n\n  // Update api limits for mibile view port\n  window.matchMedia('(max-width: 767px)').addEventListener('change', e => {\n    updateLimits();\n  });\n\n  // init\n  // rendering filters\n  updateLimits();\n  renderFilters(Object.values(FILTERS), breadcrumbsFilters);\n\n  // rendering cards by default filter\n  searchByFilter(DEFAULT_FILTER);\n})();\n"],"names":["NOTIFICATION_TYPES","THEME","showNotification","message","type","iziToast","HIDDEN_CLASS","FILTERS","DEFAULT_FILTER","SEARCH_FILTER_MAPPING","state","breadcrumbsNav","breadcrumbsHome","breadcrumbsFilters","exercisesWrapper","cards","cardsExercises","searchField","searchForm","searchFieldInput","searchFieldSubmit","searchFieldReset","paginationContainer","updateLimits","showLoader","shouldHide","loader","showResetButton","showSearchField","shouldClear","clearCards","clearBreadcrumbs","categoryItem","updateBreadcrumbs","exercise","searchByExercise","filter","keyword","limit","currentPage","params","response","Api","results","totalPages","perPage","renderByExercises","renderPagination","error","searchByFilter","renderByFilters","filterElements","filterElement","filterClickHandler","event","exerciseClickHandler","cardLink","getClosest","searchHandler","formResetHandler","searchInputHandler","paginationHandler","pageLink","renderFilters"],"mappings":"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"}