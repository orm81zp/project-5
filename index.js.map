{"version":3,"file":"index.js","sources":["../src/js/exercises.js"],"sourcesContent":["import Api from './api';\nimport { renderByExercises, renderByFilters, renderFilters } from './utils';\n\n(() => {\n  const HIDDEN_CLASS = 'hidden';\n  const FILTERS = {\n    muscles: 'Muscles',\n    bodyParts: 'Body parts',\n    equipment: 'Equipment',\n  };\n  const DEFAULT_FILTER = FILTERS.muscles;\n  const SEARCH_FILTER_MAPPING = {\n    [FILTERS.muscles]: 'muscles',\n    [FILTERS.bodyParts]: 'bodypart',\n    [FILTERS.equipment]: 'equipment',\n  };\n  const state = {\n    filter: null,\n    exercise: null,\n  };\n\n  const breadcrumbsNav = document.getElementById('breadcrumbs-nav');\n  const breadcrumbsHome = breadcrumbsNav.querySelector('.item-home');\n  const breadcrumbsFilters = document.getElementById('breadcrumbs-filters');\n  const exercisesWrapper = document.querySelector('.exercises');\n  const cards = exercisesWrapper.querySelector('.cards');\n  const cardsExercises = exercisesWrapper.querySelector('.cards-exercises');\n  const searchField = document.getElementById('search-field');\n  const searchForm = searchField.querySelector('.search-form');\n  const searchFieldInput = searchField.querySelector('.search-input');\n  const searchFieldSubmit = searchField.querySelector('.seach-submit');\n  const searchFieldReset = searchField.querySelector('.seach-reset');\n\n  // helpers\n  const showLoader = (shouldHide = false) => {\n    if (shouldHide) {\n      const loader = exercisesWrapper.querySelector('.loader');\n\n      if (loader) {\n        loader.remove();\n      }\n    } else {\n      const adjacentText = `<div class=\"loader\"></div>`;\n      exercisesWrapper.insertAdjacentHTML('beforeend', adjacentText);\n    }\n  };\n\n  /**\n   * Show / hide the search field's reset button\n   *\n   * @param {boolean} shouldHide\n   */\n  const showResetButton = (shouldHide = false) => {\n    if (shouldHide) {\n      searchFieldReset.classList.add(HIDDEN_CLASS);\n    } else {\n      searchFieldReset.classList.remove(HIDDEN_CLASS);\n    }\n  };\n\n  /**\n   * Show / hide and clear the search field's input\n   *\n   * @param {boolean} shouldHide\n   * @param {boolean} shouldClear\n   */\n  const showSearchField = (shouldHide = false, shouldClear = false) => {\n    if (shouldHide) {\n      searchField.classList.add(HIDDEN_CLASS);\n    } else {\n      searchField.classList.remove(HIDDEN_CLASS);\n    }\n\n    if (shouldClear) {\n      searchFieldInput.value = '';\n    }\n  };\n\n  /**\n   * Clear all cards, should be called before calling api\n   */\n  const clearCards = () => {\n    cards.innerHTML = '';\n    cardsExercises.innerHTML = '';\n  };\n\n  /**\n   * Clear an exercise in breadcrums\n   */\n  const clearBreadcrumbs = () => {\n    const categoryItem = breadcrumbsNav.querySelector('.item-exercise');\n    categoryItem.removeAttribute('title');\n    categoryItem.classList.remove('active');\n    categoryItem.innerText = '';\n  };\n\n  /**\n   * Add / update an exercise in breadcrums\n   */\n  const updateBreadcrumbs = exercise => {\n    const categoryItem = breadcrumbsNav.querySelector('.item-exercise');\n    categoryItem.setAttribute('title', exercise);\n    categoryItem.classList.add('active');\n    categoryItem.innerText = exercise;\n  };\n\n  /**\n   * Calls API to get exercises\n   *\n   * @param {string} filter\n   * @param {string} exercise\n   * @param {string} keyword\n   */\n  const searchByExercise = async (filter, exercise, keyword = '') => {\n    try {\n      clearCards();\n      showLoader();\n      updateBreadcrumbs(exercise);\n\n      const params = {\n        [SEARCH_FILTER_MAPPING[filter]]: exercise,\n        keyword,\n      };\n\n      const response = await Api.getExercises(params);\n      const { results } = response;\n      state.exercise = exercise;\n\n      renderByExercises(results, cardsExercises);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      showLoader(true);\n      showSearchField();\n    }\n  };\n\n  /**\n   * Calls API to get filters\n   *\n   * @param {string} filter\n   */\n  const searchByFilter = async filter => {\n    try {\n      clearCards();\n      clearBreadcrumbs();\n      showLoader();\n      showSearchField(true, true);\n      const response = await Api.getFilters({ filter });\n      const { results } = response;\n      state.filter = filter;\n\n      renderByFilters(results, cards);\n\n      // highlight active filter\n      const filterElements = breadcrumbsFilters.querySelectorAll('.item');\n\n      for (let filterElement of filterElements) {\n        if (filterElement.innerText === filter) {\n          filterElement.classList.add('active');\n        } else {\n          filterElement.classList.remove('active');\n        }\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      showLoader(true);\n    }\n  };\n\n  // filter click listerner\n  const filterClickHandler = event => {\n    event.preventDefault();\n\n    if (event.target.nodeName !== 'A') {\n      return;\n    }\n\n    const filter = event.target.innerText.trim();\n    searchByFilter(filter);\n  };\n\n  breadcrumbsFilters.addEventListener('click', filterClickHandler);\n\n  // exercise click listerner\n  const exerciseClickHandler = event => {\n    event.preventDefault();\n    const { filter } = state;\n\n    if (event.target.nodeName !== 'DIV') {\n      return;\n    }\n\n    const exercise = event.target.dataset.category.trim();\n\n    if (exercise) {\n      searchByExercise(filter, exercise);\n    }\n  };\n\n  cards.addEventListener('click', exerciseClickHandler);\n\n  // form listerners\n  const searchHandler = event => {\n    event.preventDefault();\n    const { filter, exercise } = state;\n    const keyword = searchFieldInput.value.trim();\n\n    if (keyword) {\n      searchByExercise(filter, exercise, keyword);\n    }\n  };\n\n  const formResetHandler = () => {\n    showResetButton(true);\n    const { filter, exercise } = state;\n    searchByExercise(filter, exercise);\n  };\n\n  searchFieldSubmit.addEventListener('click', searchHandler);\n  searchForm.addEventListener('submit', searchHandler);\n  searchForm.addEventListener('reset', formResetHandler);\n\n  // search input listerner\n  const searchInputHandler = event => {\n    if (event.target.value.trim()) {\n      showResetButton();\n    } else {\n      showResetButton(true);\n    }\n  };\n\n  searchFieldInput.addEventListener('input', searchInputHandler);\n\n  breadcrumbsHome.addEventListener('click', () => {\n    searchByFilter(DEFAULT_FILTER);\n  });\n\n  // init\n  // rendering filters\n  renderFilters(Object.values(FILTERS), breadcrumbsFilters);\n\n  // rendering cards by default filter\n  searchByFilter(DEFAULT_FILTER);\n})();\n"],"names":["HIDDEN_CLASS","FILTERS","DEFAULT_FILTER","SEARCH_FILTER_MAPPING","state","breadcrumbsNav","breadcrumbsHome","breadcrumbsFilters","exercisesWrapper","cards","cardsExercises","searchField","searchForm","searchFieldInput","searchFieldSubmit","searchFieldReset","showLoader","shouldHide","loader","showResetButton","showSearchField","shouldClear","clearCards","clearBreadcrumbs","categoryItem","updateBreadcrumbs","exercise","searchByExercise","filter","keyword","params","response","Api","results","renderByExercises","error","searchByFilter","renderByFilters","filterElements","filterElement","filterClickHandler","event","exerciseClickHandler","searchHandler","formResetHandler","searchInputHandler","renderFilters"],"mappings":"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"}