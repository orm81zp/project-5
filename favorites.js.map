{"version":3,"file":"favorites.js","sources":["../src/js/favorites.js"],"sourcesContent":["import Api from './api';\nimport { LOCAL_STORAGE_KEY } from './const';\nimport {\n  clearContent,\n  getClosest,\n  renderByExercises,\n  showLoader,\n} from './utils';\n\n(() => {\n  const favoritesWrapper = document.querySelector('.favorites');\n  if (!favoritesWrapper) {\n    return;\n  }\n\n  const state = {\n    exercisesIds: [],\n  };\n\n  // TODO remove mock data before going to LIVE\n  const MOCK_EXERCISES = [\n    '64f389465ae26083f39b1b16',\n    '64f389465ae26083f39b1b22',\n    '64f389465ae26083f39b19d8',\n    '64f389465ae26083f39b1b08',\n    '64f389465ae26083f39b1859',\n    '64f389465ae26083f39b1a3a',\n    '64f389465ae26083f39b1964',\n  ];\n\n  state.exercisesIds =\n    JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)) || MOCK_EXERCISES;\n  const exercisesContainer = favoritesWrapper.querySelector('.cards-exercises');\n  const favoritesWrapperContainer =\n    favoritesWrapper.querySelector('.favorites-wrapper');\n  const messageContainer = favoritesWrapper.querySelector(\n    '.notification-message'\n  );\n\n  // helpers\n  const removeIdFromStorage = exerciseId => {\n    state.exercisesIds = state.exercisesIds.filter(id => id !== exerciseId);\n  };\n\n  const exerciseClickHandler = event => {\n    event.preventDefault();\n    // check if clicked trash-button\n    const className = event.target.className;\n    const isTrashButton = className && className.includes('trash-link');\n\n    if (isTrashButton) {\n      const cardItem = getClosest(event.target, '.card-item');\n\n      if (cardItem && cardItem.dataset) {\n        removeIdFromStorage(cardItem.dataset.id);\n        const { exercisesIds } = state;\n        searchExercises(exercisesIds);\n      }\n    }\n  };\n\n  const searchExercises = async exercisesIds => {\n    if (!exercisesIds || exercisesIds.length === 0) {\n      clearContent(exercisesContainer);\n      messageContainer.classList.remove('hidden');\n      return;\n    }\n\n    messageContainer.classList.add('hidden');\n\n    try {\n      clearContent(exercisesContainer);\n      showLoader(favoritesWrapperContainer);\n      const [...exercises] = await Promise.all(\n        exercisesIds.map(id => Api.getExerciseById(id))\n      );\n      renderByExercises(exercises, exercisesContainer, true);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      showLoader(favoritesWrapperContainer, true);\n    }\n  };\n\n  exercisesContainer.addEventListener('click', exerciseClickHandler);\n  searchExercises(state.exercisesIds);\n})();\n"],"names":["favoritesWrapper","state","MOCK_EXERCISES","LOCAL_STORAGE_KEY","exercisesContainer","favoritesWrapperContainer","messageContainer","removeIdFromStorage","exerciseId","id","exerciseClickHandler","event","className","cardItem","getClosest","exercisesIds","searchExercises","clearContent","showLoader","exercises","Api","renderByExercises","error"],"mappings":"sHASC,IAAM,CACL,MAAMA,EAAmB,SAAS,cAAc,YAAY,EAC5D,GAAI,CAACA,EACH,OAGF,MAAMC,EAAQ,CACZ,aAAc,CAAE,CACpB,EAGQC,EAAiB,CACrB,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,0BACJ,EAEED,EAAM,aACJ,KAAK,MAAM,aAAa,QAAQE,CAAiB,CAAC,GAAKD,EACzD,MAAME,EAAqBJ,EAAiB,cAAc,kBAAkB,EACtEK,EACJL,EAAiB,cAAc,oBAAoB,EAC/CM,EAAmBN,EAAiB,cACxC,uBACJ,EAGQO,EAAsBC,GAAc,CACxCP,EAAM,aAAeA,EAAM,aAAa,OAAOQ,GAAMA,IAAOD,CAAU,CAC1E,EAEQE,EAAuBC,GAAS,CACpCA,EAAM,eAAc,EAEpB,MAAMC,EAAYD,EAAM,OAAO,UAG/B,GAFsBC,GAAaA,EAAU,SAAS,YAAY,EAE/C,CACjB,MAAMC,EAAWC,EAAWH,EAAM,OAAQ,YAAY,EAEtD,GAAIE,GAAYA,EAAS,QAAS,CAChCN,EAAoBM,EAAS,QAAQ,EAAE,EACvC,KAAM,CAAE,aAAAE,CAAc,EAAGd,EACzBe,EAAgBD,CAAY,CAC7B,CACF,CACL,EAEQC,EAAkB,MAAMD,GAAgB,CAC5C,GAAI,CAACA,GAAgBA,EAAa,SAAW,EAAG,CAC9CE,EAAab,CAAkB,EAC/BE,EAAiB,UAAU,OAAO,QAAQ,EAC1C,MACD,CAEDA,EAAiB,UAAU,IAAI,QAAQ,EAEvC,GAAI,CACFW,EAAab,CAAkB,EAC/Bc,EAAWb,CAAyB,EACpC,KAAM,CAAC,GAAGc,CAAS,EAAI,MAAM,QAAQ,IACnCJ,EAAa,IAAIN,GAAMW,EAAI,gBAAgBX,CAAE,CAAC,CACtD,EACMY,EAAkBF,EAAWf,EAAoB,EAAI,CACtD,OAAQkB,EAAO,CACd,QAAQ,IAAIA,CAAK,CACvB,QAAc,CACRJ,EAAWb,EAA2B,EAAI,CAC3C,CACL,EAEED,EAAmB,iBAAiB,QAASM,CAAoB,EACjEM,EAAgBf,EAAM,YAAY,CACpC,GAAI"}